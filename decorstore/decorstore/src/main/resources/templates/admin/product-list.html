<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<header th:replace="admin/fragments/head::head"></header>
<body>
<div class="wrapper">
    <div class="container mt-5">
        <!-- Sidebar -->
        <div th:replace="admin/fragments/sidebar :: slide"></div>

        <h2 class="mb-4">Danh sách sản phẩm</h2>

        <!-- Khu vực tìm kiếm -->
        <form th:action="@{/product/search}" method="get" class="row g-2 mb-3">
            <div class="col-md-4">
                <input type="text" name="keyword" class="form-control"
                       placeholder="Nhập tên sản phẩm cần tìm..." th:value="${keyword}">
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-success w-100">
                    <i class="fas fa-search"></i> Tìm kiếm
                </button>
            </div>
            <div class="col-md-2">
                <a th:href="@{/product}" class="btn btn-secondary w-100">
                    <i class="fas fa-sync"></i> Làm mới
                </a>
            </div>
            <div class="col-md-4 text-end">
                <a th:href="@{/product/create}" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Thêm sản phẩm
                </a>
            </div>
        </form>

        <!-- Bảng sản phẩm -->
        <div class="table-responsive" th:if="${products != null and products.size() > 0}">
            <table class="table table-bordered table-striped align-middle text-center">
                <thead class="table-dark">
                <tr>
                    <th>#</th>
                    <th>Tên sản phẩm</th>
                    <th>Mô tả</th>
                    <th>Ảnh chính</th>
                    <th>Danh mục</th>
                    <th>Giá</th>
                    <th>Số lượng</th>
                    <th>Slug</th>
                    <th>Meta Title</th>
                    <th>Meta Description</th>
                    <th>Trạng thái</th>
                    <th>Ngày tạo</th>
                    <th>Ngày cập nhật</th>
                    <th>Tồn kho</th>
                    <th>Hành động</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="product : ${products}">
                    <td th:text="${product.id}"></td>
                    <td th:text="${product.name}"></td>
                    <td th:text="${product.description}"></td>
                    <td>
                        <img th:if="${product.mainImage != null}"
                             th:src="@{/uploads/{img}(img=${product.mainImage})}"
                             alt="Product Image" width="60" height="60"
                             class="rounded shadow-sm border"/>
                        <span th:if="${product.mainImage == null}">No Image</span>
                    </td>
                    <td th:text="${product.category != null ? product.category.name : 'N/A'}"></td>
                    <td th:text="${product.price}"></td>
                    <td th:text="${product.quantity}"></td>
                    <td th:text="${product.slug}"></td>
                    <td th:text="${product.metaTitle}"></td>
                    <td th:text="${product.metaDescription}"></td>
                    <td>
                        <span th:text="${product.isActive ? 'Active' : 'Inactive'}"
                              th:classappend="${product.isActive ? 'text-success fw-bold' : 'text-danger fw-bold'}">
                        </span>
                    </td>
                    <td th:text="${#temporals.format(product.createdDate, 'yyyy-MM-dd HH:mm')}"></td>
                    <td th:text="${#temporals.format(product.updatedDate, 'yyyy-MM-dd HH:mm')}"></td>
                    <td th:text="${product.stock != null ? product.stock : 0}"></td>
                    <td>
                        <a th:href="@{/product/edit/{id}(id=${product.id})}"
                           class="btn btn-warning btn-sm">
                            <i class="fas fa-edit"></i> Sửa
                        </a>
                        <a th:href="@{/product/delete/{id}(id=${product.id})}"
                           class="btn btn-danger btn-sm"
                           onclick="return confirm('Bạn có chắc chắn muốn xóa sản phẩm này không?')">
                            <i class="fas fa-trash"></i> Xóa
                        </a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div th:if="${products == null or products.size() == 0}" class="alert alert-info text-center mt-3">
            Không có sản phẩm nào được tìm thấy.
        </div>
    </div>
</div>
<div th:replace="admin/fragments/script::script"></div>

</body>
</html>
