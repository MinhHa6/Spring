<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head th:replace="admin/fragments/head :: head"></head>
<body>
<div class="d-flex">
    <!-- Sidebar -->
    <div th:replace="admin/fragments/sidebar :: slide"></div>

    <!-- N·ªôi dung ch√≠nh -->
    <div class="content flex-grow-1 p-4" style="background-color: #f8f9fa; min-height: 100vh;">
        <div class="card shadow-sm p-4 border-0">
            <!-- Ti√™u ƒë·ªÅ & n√∫t th√™m -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h4 class="fw-bold mb-0 text-primary">
                    <i class="fas fa-users me-2"></i>Danh s√°ch kh√°ch h√†ng
                </h4>
                <a th:href="@{/customers/create}" class="btn btn-primary">
                    <i class="fa fa-plus"></i> Th√™m kh√°ch h√†ng m·ªõi
                </a>
            </div>

            <!-- Th√¥ng b√°o -->
            <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
                <i class="fas fa-check-circle"></i> <span th:text="${success}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
                <i class="fas fa-exclamation-circle"></i> <span th:text="${error}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <!-- T√¨m ki·∫øm -->
            <form class="input-group mb-4" th:action="@{/customers/search}" method="get">
                <input type="text" class="form-control" name="keyword" th:value="${keyword}"
                       placeholder="üîç Nh·∫≠p t√™n, email ho·∫∑c s·ªë ƒëi·ªán tho·∫°i...">
                <button class="btn btn-outline-primary" type="submit">
                    <i class="fas fa-search"></i> T√¨m ki·∫øm
                </button>
            </form>

            <!-- B·∫£ng kh√°ch h√†ng -->
            <div th:if="${#lists.isEmpty(customers)}" class="alert alert-info text-center">
                <i class="fas fa-info-circle"></i> Kh√¥ng c√≥ kh√°ch h√†ng n√†o ƒë∆∞·ª£c t√¨m th·∫•y.
            </div>

            <div class="table-responsive" th:if="${!#lists.isEmpty(customers)}">
                <table class="table table-hover align-middle text-center">
                    <thead class="table-light">
                    <tr>
                        <th>Avatar</th>
                        <th>T√™n kh√°ch h√†ng</th>
                        <th>Email</th>
                        <th>S·ªë ƒëi·ªán tho·∫°i</th>
                        <th>ƒê·ªãa ch·ªâ</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>Ng√†y t·∫°o</th>
                        <th>H√†nh ƒë·ªông</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="customer : ${customers}">
                        <td>
                            <img th:if="${customer.avatar != null}"
                                 th:src="${customer.avatar.startsWith('/uploads/') ? customer.avatar : '/uploads/' + customer.avatar}"
                                 class="rounded-circle shadow-sm"
                                 style="width: 55px; height: 55px; object-fit: cover;"
                                 alt="Avatar">
                            <img th:if="${customer.avatar == null}"
                                 src="https://via.placeholder.com/55x55?text=üë§"
                                 class="rounded-circle shadow-sm"
                                 alt="No Avatar">
                        </td>
                        <td><strong th:text="${customer.name}">Nguy·ªÖn VƒÉn A</strong></td>
                        <td th:text="${customer.user.email}">email@example.com</td>
                        <td th:text="${customer.phone}">0123456789</td>
                        <td th:text="${#strings.abbreviate(customer.address, 35)}">123 ABC, Qu·∫≠n 1, TP.HCM</td>
                        <td>
                                <span th:if="${customer.active}" class="badge bg-success">
                                    <i class="fas fa-check-circle"></i> Ho·∫°t ƒë·ªông
                                </span>
                            <span th:unless="${customer.active}" class="badge bg-secondary">
                                    <i class="fas fa-lock"></i> Kh√≥a
                                </span>
                        </td>
                        <td th:text="${#temporals.format(customer.createdDate, 'dd/MM/yyyy HH:mm')}"></td>
                        <td>
                            <div class="btn-group" role="group">
                                <a th:href="@{'/customers/detail/' + ${customer.id}}" class="btn btn-sm btn-outline-info" title="Xem">
                                    <i class="fa fa-eye"></i>
                                </a>
                                <a th:href="@{'/customers/edit/' + ${customer.id}}" class="btn btn-sm btn-outline-warning" title="S·ª≠a">
                                    <i class="fa fa-edit"></i>
                                </a>
                                <a th:href="@{'/customers/toggle-active/' + ${customer.id}}" class="btn btn-sm btn-outline-secondary" title="ƒê·ªïi tr·∫°ng th√°i">
                                    <i class="fas fa-toggle-on"></i>
                                </a>
                                <a th:href="@{'/customers/delete/' + ${customer.id}}"
                                   class="btn btn-sm btn-outline-danger"
                                   onclick="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a kh√°ch h√†ng n√†y kh√¥ng?')"
                                   title="X√≥a">
                                    <i class="fa fa-trash"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <!-- T·ªïng s·ªë kh√°ch h√†ng -->
            <div class="mt-3 text-end text-muted">
                T·ªïng s·ªë kh√°ch h√†ng: <strong th:text="${#lists.size(customers)}">0</strong>
            </div>
        </div>
    </div>
</div>

<div th:replace="admin/fragments/script :: script"></div>
</body>
</html>
